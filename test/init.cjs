"use strict";var f=Object.defineProperty;var g=(o,e,t)=>e in o?f(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var i=(o,e,t)=>g(o,typeof e!="symbol"?e+"":e,t);const c=require("./constants-DQ1zftz-.cjs"),C=require("./TestApp.cjs");class F extends Error{constructor(e="DRE_ERROR",t,...l){super(t,l),this.name=`${c.MODULE_ID}.${e}`}}const E=class E extends F{constructor(e,t,l,...s){super(E.ID,`${E.BASE_MSG} reason: ${l} param: ${e}, value: ${t}`,s)}};i(E,"ID","INVALID_FUNC_ARG"),i(E,"BASE_MSG","An argument provided to the function was invalid.");let r=E;const{RegionBehaviorType:_}=foundry.data.regionBehaviors,{SetField:$,StringField:A,DocumentUUIDField:D}=foundry.data.fields,a=class a extends _{static defineSchema(){return{events:this._createEventsField()}}async _handleRegionEvent(e){console.debug(`${LOCALIZATION_PREFIXES} _handleRegionEvent`,e)}static _createOptionsField(e,t,l,s,I){if(!e instanceof Array)throw new r("optsArray",e,"Must be an instance of Array<T>.");if(e.length<1)throw new r("optsArray",e,"optsArray must have at least one element.");if(s&&s>-1&&e.length<=s)throw new r("defaultOptIndex",s,`Index ${s} is not in optsArray.`);if(!t)throw new r("localizationFieldPath",t,"Must be a valid localization path.");let d={required:!0,nullable:!1,initial:e[0]},O={};l&&(O.required=l),s&&(O.initial=e[s]),I&&I.hasOwnProperty("choices")&&(console.warn("Choices key found on fieldOptions. Deleting choices and regenerating with given params."),delete I.choices),Object.assign(d,O,I),d.choices={};for(const S of e)d.choices[S]=`${t}.${S}.label`;return console.log("setField options: ",d),new A(d)}};i(a,"BEHAVIOR_ID","BASE"),i(a,"LOCALIZATION_PREFIXES",[`${c.BEHAVIOR_PREFIX}.${a.BEHAVIOR_ID}`]),i(a,"events",{}),i(a,"EFFECT_SOURCE_CHOICES",["ACTOR","ENVIRONMENT","PLACEABLE_OBJECT"]);let h=a;foundry.data.regionBehaviors;const{SetField:N,StringField:M,DocumentUUIDField:L}=foundry.data.fields;foundry.CONST.REGION_EVENTS;const n=class n extends h{static defineSchema(){const e={itemOpt:this._createOptionsField(this.ITEM_OPTION_CHOICES,`${this.LOCALIZATION_PREFIXES}.FIELDS.itemOpt`,!0,0),effectSource:this._createOptionsField(this.EFFECT_SOURCE_CHOICES,`${this.LOCALIZATION_PREFIXES}.FIELDS.effectSource`,!0,0),events:this._createEventsField(),item:new L({type:"Item",validate:this.validateItem})};return console.log(`Schema Defined for ${n.LOCALIZATION_PREFIXES}:`,e),e}static validateItem(e){return console.log("Item Validator: ",e),!0}async _handleRegionEvent(e){if(console.debug(`${LOCALIZATION_PREFIXES} _handleRegionEvent`,e),!this.uuid)return;const t=await fromUuid(this.uuid);if(!(t instanceof Macro)){console.error(`${this.uuid} does not exist`);return}await t.execute({scene:this.scene,region:this.region,behavior:this.behavior,event:e,actor:null,token:null})}};i(n,"BEHAVIOR_ID","ITEM"),i(n,"LOCALIZATION_PREFIXES",[`${c.BEHAVIOR_PREFIX}.${n.BEHAVIOR_ID}`]),i(n,"events",{}),i(n,"ITEM_OPTION_CHOICES",["USE_ITEM","USE_ITEM_COPY"]);let u=n;console.log("Initilizing module: ",c.MODULE_ID);Hooks.once("init",()=>{var o;console.log("Init code for ",c.MODULE_ID),console.log("init this",void 0),console.log("config",CONFIG),console.log("check object to assign",(o=CONFIG==null?void 0:CONFIG.RegionBehavior)==null?void 0:o.dataModels),Object.assign(CONFIG.RegionBehavior.dataModels,{[`${c.MODULE_ID}.DreRegionBehaviorItemType`]:u})});Hooks.once("ready",()=>{var e;console.log("Ready code for the module ",c.MODULE_ID);const o=new C;console.log("check object to assign",(e=CONFIG==null?void 0:CONFIG.RegionBehavior)==null?void 0:e.dataModels),o.render(!0)});Hooks.on("renderRegionBehaviorConfig",(o,e,t)=>{o.document.type.includes(`${c.MODULE_ID}.DreRegionBehavior`)&&console.log("DRE region behavior config rendered!",o,e,t)});
//# sourceMappingURL=init.cjs.map
